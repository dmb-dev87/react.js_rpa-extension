!function(t){function e(e){for(var r,i,u=e[0],c=e[1],s=e[2],l=0,f=[];l<u.length;l++)i=u[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(d&&d(e);f.length;)f.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,u=1;u<n.length;u++){var c=n[u];0!==o[c]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={2:0},a=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var d=c;a.push([632,1,0]),n()}({100:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(3),o=n.n(r),a=n(4),i=n(2),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var s,d=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.activeDownloads=[],this.eventsBound=!1,this.filterActiveDownloads=function(t){e.activeDownloads=e.activeDownloads.filter(t),0===e.activeDownloads.length&&e.unbindEvents()},this.createdListener=function(t){if(e.isActive()){Object(a.a)("download on created",t);var n=e.activeDownloads.find((function(t){return!t.id}));n&&u(n,u({id:t.id},!n.wait&&n.timeout>0?{}:{timeoutTimer:setTimeout((function(){n.reject(new Error("download timeout "+n.timeout/1e3+"s")),e.filterActiveDownloads((function(t){return n.uid!==t.uid}))}),n.timeout),countDownTimer:setInterval((function(){if(e.countDownHandler){var t=n.past,r=(void 0===t?0:t)+1e3;e.countDownHandler({total:n.timeout,past:r}),u(n,{past:r})}}),1e3)}))}},this.changedListener=function(t){if(e.isActive()){Object(a.a)("download on changed",t);var n=e.findById(t.id);if(n&&t.state){var r=function(){},o=!1;switch(t.state.current){case"complete":r=function(){return n.resolve(!0)},o=!0;break;case"interrupted":r=function(){return n.reject(new Error("download interrupted"))},o=!0}o&&(clearTimeout(n.timeoutTimer),clearInterval(n.countDownTimer),e.filterActiveDownloads((function(e){return e.id!==t.id}))),r()}}},this.determineFileNameListener=function(t,n){if(e.isActive()){Object(a.a)("download on determine",t);var r=e.findById(t.id);if(r){var o=r.fileName.trim(),i=""===o||"*"===o?null:o;return i?n({filename:i,conflictAction:"uniquify"}):void 0}}}}return c(t,[{key:"isActive",value:function(){return this.activeDownloads.length>0}},{key:"findById",value:function(t){return this.activeDownloads.find((function(e){return e.id===t}))}},{key:"bindEvents",value:function(){this.eventsBound||(o.a.downloads.onCreated.addListener(this.createdListener),o.a.downloads.onChanged.addListener(this.changedListener),o.a.downloads.onDeterminingFilename&&o.a.downloads.onDeterminingFilename.addListener(this.determineFileNameListener),this.eventsBound=!0)}},{key:"unbindEvents",value:function(){this.eventsBound&&(o.a.downloads.onCreated.removeListener&&o.a.downloads.onCreated.removeListener(this.createdListener),o.a.downloads.onChanged.removeListener&&o.a.downloads.onChanged.removeListener(this.changedListener),o.a.downloads.onDeterminingFilename&&o.a.downloads.onDeterminingFilename.removeListener&&o.a.downloads.onDeterminingFilename.removeListener(this.determineFileNameListener),this.eventsBound=!1)}},{key:"reset",value:function(){this.activeDownloads.forEach((function(t){t.timeoutTimer&&clearTimeout(t.timeoutTimer),t.countDownTimer&&clearInterval(t.countDownTimer)})),this.activeDownloads=[],this.unbindEvents()}},{key:"prepareDownload",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.activeDownloads.find((function(t){return!t.id}));if(r)throw new Error("only one not-created download allowed at a time");this.bindEvents();var o=u({timeoutForStart:1e4,timeout:6e4,wait:!1},n),a=new Promise((function(n,r){var i=Math.floor(1e3*Math.random())+1*new Date;setTimeout((function(){e.activeDownloads.push({uid:i,resolve:n,reject:r,fileName:t,promise:a,timeoutForStart:o.timeoutForStart,timeout:o.timeout,wait:o.wait})}),0)}));return a}},{key:"waitForDownloadIfAny",value:function(){var t=this,e=this.activeDownloads.find((function(t){return!t.id}));if(e)return Object(i.until)("download start",(function(){return{pass:!!e.id,result:!0}}),50,e.timeoutForStart).then((function(){return t.waitForDownloadIfAny()}));var n=this.activeDownloads.find((function(t){return t.wait&&t.id}));return n?n.promise.then((function(){return t.waitForDownloadIfAny()})):Promise.resolve(!0)}},{key:"onCountDown",value:function(t){this.countDownHandler=t}},{key:"hasPendingDownload",value:function(){return!!this.activeDownloads.find((function(t){return!t.id}))}}]),t}(),l=(s=void 0,function(){return s||(s=new d),s})},148:function(t,e,n){"use strict";n.r(e),n.d(e,"resizeWindow",(function(){return c})),n.d(e,"resizeViewport",(function(){return s})),n.d(e,"resizeViewportOfTab",(function(){return d})),n.d(e,"getWindowSize",(function(){return l})),n.d(e,"getFocusedWindowSize",(function(){return f}));var r=n(3),o=n.n(r),a=n(2),i=n(4),u=function(t,e,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=a||n<t-n-r;if(Object(i.a)("calcOffset",t,n,r,o,a),u)return n;if(!u){return r+n-o}};function c(t,e){var n=screen.availWidth,r=screen.availHeight,a=screen.availLeft,i=screen.availTop;return o.a.windows.get(t).then((function(c){var s=c.left,d=c.top,l=c.width,f=c.height;return o.a.windows.update(t,e).then((function(c){var h=u(n,a,s,l,c.width),b=u(r,i,d,f,c.height,!0);o.a.windows.update(t,{left:h,top:b});var m={width:c.width,height:c.height};return{actual:m,desired:e,diff:["width","height"].filter((function(t){return m[t]!==e[t]}))}}))}))}function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=2;return Object(i.a)("resizeViewport, ROUND",n),l(t).then((function(o){Object(i.a)("currentSize!!!!"),h(o);var u=o.window.width-o.viewport.width,d=o.window.height-o.viewport.height,f={width:u+e.width,height:d+e.height};return Object(i.a)("size set to",f),c(t,f).then((function(){return l(t)})).then((function(o){Object(i.a)("newSize!!!!"),h(o);var u={actual:o.viewport,desired:e,diff:["width","height"].filter((function(t){return o.viewport[t]!==e[t]}))};return 0===u.diff.length||n>=r?u:Object(a.delay)((function(){}),0).then((function(){return s(t,e,n+1)}))}))}))}function d(t,e){return o.a.tabs.get(t).then((function(t){return s(t.windowId,e)}))}function l(t){return o.a.windows.get(t,{populate:!0}).then((function(t){var e=t.tabs.find((function(t){return t.active}));return{window:{width:t.width,height:t.height,left:t.left,top:t.top},viewport:{width:e.width,height:e.height}}}))}function f(){return o.a.windows.getLastFocused().then((function(t){return l(t.id)}))}function h(t){Object(i.a)(t.window,t.viewport),Object(i.a)("dx = ",t.window.width-t.viewport.width),Object(i.a)("dy = ",t.window.height-t.viewport.height)}},154:function(t,e,n){"use strict";var r=function(){var t,e,n=document.createElement("div");return n.setAttribute("contenteditable",!0),n.id="clipboard_textarea",t=n,e={position:"aboslute",top:"-9999px",left:"-9999px"},Object.keys(e).forEach((function(n){t.style[n]=e[n]})),document.body.appendChild(n),n},o=function(t){var e=document.getElementById("clipboard_textarea")||r(),n=void 0;try{n=t(e)}catch(t){console.error(t)}finally{e.innerHTML=""}return n},a={set:function(t){o((function(e){e.innerText=t,e.focus(),document.execCommand("selectAll",!1,null),document.execCommand("copy")}))},get:function(){return o((function(t){return t.blur(),t.focus(),document.execCommand("paste")?t.innerText:"no luck"}))}};e.a=a},32:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache={}}return o(t,[{key:"get",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Object(r.until)("ipc by tab id",(function(){var n=e.cache[t],r=n&&1===n.status,a=n&&n.ipc;return{pass:r&&!!a&&(o===1/0||o>n.timestamp),result:a}}),100,n)}},{key:"set",value:function(t,e,n){this.cache[t]={ipc:e,cuid:n,status:1,timestamp:(new Date).getTime()}}},{key:"setStatus",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.cache[t];return!!r&&(r.status=e,n&&(r.timestamp=(new Date).getTime()),!0)}},{key:"enable",value:function(t){return this.setStatus(t,1,!0)}},{key:"disable",value:function(t){return this.setStatus(t,0)}},{key:"getCuid",value:function(t){var e=this.cache[t];return e?e.cuid:null}},{key:"del",value:function(t){delete this.cache[t]}}]),t}(),i=void 0;function u(){return i||(i=new a)}},4:function(t,e,n){"use strict";var r,o,a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.a=(r=!!!1,o=["log","info","warn","error"].reduce((function(t,e){return t[e]=function(){for(var t,n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];r&&(t=console)[e].apply(t,[(new Date).toISOString()," - "].concat(o))},t}),{}),a(o.log,o,{enable:function(){r=!0},disable:function(){r=!1}}))},411:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r,o,a=n(3),i=n.n(a),u=n(2),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=(r={connected:null,cleanupTimer:null},o=function(t){c(r,t)},function(t,e){var n=function(t){return n=t,(e=r.connected)&&n&&e.tabId&&n.tabId&&e.tabId===n.tabId?(r.cleanupTimer&&clearTimeout(r.cleanupTimer),o({cleanupTimer:null}),Promise.resolve()):a(r.connected).then((function(){return i.a.debugger.attach(t,"1.2")})).then((function(){return o({connected:t})}));var e,n},a=function(t){return t?i.a.debugger.detach(t).then((function(){r.cleanupTimer&&clearTimeout(r.cleanupTimer),o({connected:null,cleanupTimer:null})}),(function(t){return console.error("error in detach",t.stack)})):Promise.resolve()},u=function(e,n){return i.a.debugger.sendCommand(t,e,n)},c=function(t){i.a.debugger.onEvent.addListener(t)},s=function(t){i.a.debugger.onDetach.addListener(t)};return new Promise((function(r,i){var d=function(e,n){var u;return u=setTimeout((function(){return a(t)}),0),o({cleanupTimer:u}),e?i(e):r(n)};return n(t).then((function(){e({sendCommand:u,onEvent:c,onDetach:s,done:d})}),(function(t){return i(t)}))}))}),d=function(t){var e=t.tabId,n=t.selector,r=t.files;return s({tabId:e},(function(t){return Object(u.composePromiseFn)(function(t){var e=t.sendCommand;t.done;return Object(u.partial)((function(t,n){return e("DOM.setFileInputFiles",{nodeId:n,files:t}).then((function(){return!0}))}))}(t)(r),function(t){var e=t.sendCommand;t.done;return Object(u.partial)((function(t,n){return e("DOM.querySelector",{nodeId:n,selector:t}).then((function(t){return t&&t.nodeId}))}))}(t)(n),(function(t){return t.nodeId}),function(t){var e=t.sendCommand;t.done;return function(){return e("DOM.getDocument").then((function(t){return t.root}))}}(t))().then((function(e){return t.done(null,e)}))}))}},55:function(t,e,n){"use strict";n.d(e,"h",(function(){return d})),n.d(e,"c",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"b",(function(){return E})),n.d(e,"e",(function(){return O})),n.d(e,"d",(function(){return y})),n.d(e,"a",(function(){return I})),n.d(e,"f",(function(){return T}));var r=n(3),o=n.n(r),a=n(5),i=n(2),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function s(t){return new Promise((function(e,n){var r=new Image;r.onload=function(){e({width:r.naturalWidth,height:r.naturalHeight})},r.src=t}))}function d(t,e){return 1===e?Promise.resolve(t):new Promise((function(e,n){var r=new Image;r.onload=function(){e(r)},r.src=t})).then((function(n){var r=g(n.naturalWidth,n.naturalHeight,e);return v({canvas:r,dataURI:t,x:0,y:0,width:n.naturalWidth*e,height:n.naturalHeight*e}).then((function(){return r.toDataURL()}))}))}function l(t,e){var n="function"==typeof e,r=e&&!n,a=o.a.tabs.captureVisibleTab(null,{format:"png"}),i=r?Promise.resolve(e):a.then((function(e){return function(t,e,n){return Promise.all([s(t),o.a.tabs.get(e)]).then((function(t){var e=c(t,2),r=e[0];return e[1].width*n/r.width}))}(e,t,window.devicePixelRatio)}));return Promise.all([a,i]).then((function(t){var o=c(t,2),a=o[0],i=o[1];return!r&&n&&e(i),1===i?a:d(a,i)}))}function f(){var t=void 0;return function(e){return l(e,t||function(e){t=e})}}function h(t,e){return function(t){return l(t).then(i.dataURItoBlob)}(t).then((function(t){return Object(a.getStorageManager)().getScreenshotStorage().overwrite(e,t).then((function(t){return{url:t,fileName:e}}))}))}function b(t){return t.reduce((function(t,e){return t.then(e)}),Promise.resolve())}function m(t){for(var e=t.pageWidth,n=t.pageHeight,r=t.windowWidth,o=t.windowHeight,a=t.topPadding,i=void 0===a?150:a,u=r,c=o-(o>i?i:0),s=[],d=n-o;d>-1*c;d-=c)for(var l=0;l<e;l+=u)s.push({x:l,y:d});return s}function w(t,e){for(var n=t.x,r=t.y,o=t.width,a=t.height,i=(e.pageWidth,e.pageHeight,e.windowWidth),u=e.windowHeight,c=(e.originalX,e.originalY,e.topPadding),s=void 0===c?150:c,d=i,l=u-(u>s?s:0),f=[],h=r+a-u;h>r-l;h-=l)for(var b=n;b<n+o;b+=d)f.push({x:b,y:h});return 0===f.length&&f.push({x:n,y:r+a-u}),f}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=document.createElement("canvas");return r.width=t*n,r.height=e*n,r}function v(t){var e=t.canvas,n=t.dataURI,r=t.x,o=t.y,a=t.width,i=t.height;return new Promise((function(t,u){var c=new Image;c.onload=function(){e.getContext("2d").drawImage(c,0,0,c.width,c.height,r,o,a||c.width,i||c.height),t({x:r,y:o,width:a,height:i})},c.src=n}))}function p(t,e,n){return t().then((function(t){return delete t.sender,n(t).then((function(n){return e(t),n}))}))}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I,n=e.startCapture,r=e.scrollPage,o=e.endCapture,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=u({blob:!1},a);return p(n,o,(function(e){var n=e.devicePixelRatio,o=Math.floor(32767/n);e.pageWidth=Math.min(o,e.pageWidth),e.pageHeight=Math.min(o,e.pageHeight);var a=f(),u=g(e.pageWidth,e.pageHeight,n),s=m(e),d=s.map((function(o,i){return function(){return r(o,{index:i,total:s.length}).then((function(r){return a(t).then((function(t){return v({canvas:u,dataURI:t,x:r.x*n,y:r.y*n,width:e.windowWidth*n,height:e.windowHeight*n})}))}))}})),l=c.blob?i.dataURItoBlob:function(t){return t};return b(d).then((function(){return l(u.toDataURL())}))}))}function O(t,e){var n=e.rect,r=e.devicePixelRatio,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=u({blob:!1},o),c=a.blob?i.dataURItoBlob:function(t){return t},s=r,d=g(n.width,n.height,s);return l(t).then((function(t){return v({canvas:d,dataURI:t,x:-1*n.x*r,y:-1*n.y*r})})).then((function(){return c(d.toDataURL())}))}function y(t,e,n){var r=e.rect,o=e.devicePixelRatio,a=n.startCapture,c=n.scrollPage,s=n.endCapture,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=u({blob:!1},d),h=l.blob?i.dataURItoBlob:function(t){return t},m=o;return p(a,s,(function(e){var n=Math.floor(32767/m);e.pageWidth=Math.min(n,e.pageWidth),e.pageHeight=Math.min(n,e.pageHeight);var a=f(),i=g(r.width,r.height,m),u=w(r,e);return b(u.map((function(n,s){return function(){return c(n,{index:s,total:u.length}).then((function(n){return a(t).then((function(t){return v({canvas:i,dataURI:t,x:(n.x-r.x)*o,y:(n.y-r.y)*o,width:e.windowWidth*o,height:e.windowHeight*o})}))}))}}))).then((function(){return h(i.toDataURL())}))}))}var I={getPageInfo:function(){var t=document.body,e=[document.documentElement.clientWidth,document.documentElement.scrollWidth,document.documentElement.offsetWidth,t?t.scrollWidth:0,t?t.offsetWidth:0],n=[document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight,t?t.scrollHeight:0,t?t.offsetHeight:0];return{pageWidth:Math.max.apply(Math,e),pageHeight:Math.max.apply(Math,n),windowWidth:window.innerWidth,windowHeight:window.innerHeight,hasBody:!!t,originalX:window.scrollX,originalY:window.scrollY,originalOverflowStyle:document.documentElement.style.overflow,originalBodyOverflowYStyle:t&&t.style.overflowY,devicePixelRatio:window.devicePixelRatio}},startCapture:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hideScrollbar,n=void 0===e||e,r=document.body,o=I.getPageInfo();return r&&(r.style.overflowY="visible"),n&&(document.documentElement.style.overflow="hidden"),Promise.resolve(o)},scrollPage:function(t){var e=t.x,n=t.y;return window.scrollTo(e,n),Object(i.delay)((function(){return{x:window.scrollX,y:window.scrollY}}),100)},endCapture:function(t){var e=t.originalX,n=t.originalY,r=t.hasBody,o=t.originalOverflowStyle,a=t.originalBodyOverflowYStyle;return r&&(document.body.style.overflowY=a),document.documentElement.style.overflow=o,window.scrollTo(e,n),Promise.resolve(!0)}};function T(t,e,n){return E(t,n,{blob:!0}).then((function(t){return Object(a.getStorageManager)().getScreenshotStorage().overwrite(e,t).then((function(t){return{url:t,fileName:e}}))}))}},60:function(t,e,n){var r=n(2).retry,o=function(t){return t instanceof Error?{isError:!0,name:t.name,message:t.message,stack:t.stack}:t};function a(t){var e=t.ask,n=t.answer,a=t.timeout,i=t.onAnswer,u=t.onAsk,c=t.destroy,s=t.checkReady||function(){return Promise.resolve(!0)},d={},l=[],f=function(t,e,n){l.push({uid:t,cmd:e,args:n})},h=f,b=function(t,e,n,r,o){for(var a=0,i=t.length;a<i;a++){var u;try{u=t[a](e,n)}catch(t){return o(t)}if(void 0!==u)return r(u)}};a=a||-1,i((function(t,e,n){if(t&&!1===d[t])delete d[t];else if(t&&d[t]){var r=d[t][0],a=d[t][1];delete d[t],e?a(o(e)):r(n)}})),u((function(t,e,r){if(a>0&&setTimeout((function(){l&&l.find((function(e){return e.uid===t}))&&n(t,new Error("ipcPromise: answer timeout "+a+' for cmd "'+e+'", args "'+r+'"'))}),a),h!==f)return new Promise((function(t,n){b(h,e,r,t,n)})).then((function(o){if(void 0===o)return f(t,e,r);n(t,null,o)}),(function(e){n(t,o(e),null)}));f(t,e,r)}));return{ask:function(t,e){return function(){for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];var i=r(t,{shouldRetry:function(){return!0},retryInterval:100,timeout:5e3});return i().then((function(){return e.apply(void 0,o)}))}}(s,(function(t,n,r){var o="ipcp_"+1*new Date+"_"+Math.round(1e3*Math.random()),i=r||a;return i>0&&setTimeout((function(){var e;d&&d[o]&&(e=d[o][1],d[o]=!1,e(new Error("ipcPromise: onAsk timeout "+i+' for cmd "'+t+'", args "'+n+'"')))}),i),e(o,t,n||[]),new Promise((function(t,e){d[o]=[t,e]}))})),onAsk:function(t){Array.isArray(h)?h.push(t):h=[t];var e=l.map((function(t){return new Promise((function(e,n){b(h,t.cmd,t.args,e,n)})).then((function(e){if(void 0!==e)return n(t.uid,null,e),t.uid}),(function(e){return n(t.uid,e,null),t.uid}))}));Promise.all(e).then((function(t){var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;if(void 0!==i){var u=l.findIndex((function(t){return t.uid===i}));l.splice(u,1)}}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}}))},destroy:function(t){c&&c(),e=null,n=null,i=null,u=null,l=null,t||Object.keys(d).forEach((function(t){var e=d[t][1];e&&e(new Error("IPC Promise has been Destroyed.")),delete d[t]}))}}}a.serialize=function(t){return{ask:function(e,n,r){return t.ask(e,JSON.stringify(n),r)},onAsk:function(e){return t.onAsk((function(t,n){return e(t,JSON.parse(n))}))},destroy:t.destroy}},t.exports=a},632:function(t,e,n){"use strict";n.r(e),function(t){var e=n(3),r=n.n(e),o=n(2),a=n(75),i=n(8),u=n(4),c=n(154),s=n(55),d=n(31),l=n(411),f=n(100),h=n(71),b=n(5),m=n(27),w=n(148),g=n(32),v=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var E=/Linux/i.test(window.navigator.userAgent)?200:0,O={status:i.a.NORMAL,tabIds:{lastInspect:null,lastRecord:null,toInspect:null,firstRecord:null,toRecord:null,lastPlay:null,firstPlay:null,toPlay:null,panel:null},pullback:!1,heartBeatSecret:0,xClickNeedCalibrationInfo:null},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.disabled,n=void 0!==e&&e;O.heartBeatSecret=n?-1:(Math.max(0,O.heartBeatSecret)+1)%1e4},I=function(t,e){return r.a.tabs.get(t).then((function(t){return(e?r.a.windows.update(t.windowId,{focused:!0}):Promise.resolve()).then((function(){return r.a.tabs.update(t.id,{active:!0})})).then((function(){return t}))}))},T=function(t,e){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=O.tabIds[t];return a?r.a.tabs.get(a).then((function(t){if(!t)throw new Error("The "+e+" tab seems to be closed");return Object(g.a)().get(t.id,n,o).catch((function(t){throw new Error("No ipc available for the "+e+" tab")}))})):Promise.reject(new Error("No tab for "+e+" yet"))}},_=T("toRecord","recording"),A=T("toPlay","playing commands"),S=T("panel","dashboard"),R=function(t){var e=new Error("No connection to browser tab");Object(u.a)("getPlayTab",t,O.tabIds.toPlay);var n,o=function(t){if(!t)throw e;return function(t){return r.a.tabs.create({url:t,active:!0})}(t).then((function(t){return O.tabIds.lastPlay=O.tabIds.toPlay,O.tabIds.toPlay=O.tabIds.firstPlay=t.id,t}))};if(!O.tabIds.toPlay&&!t)throw e;return O.tabIds.toPlay?(n=O.tabIds.toPlay,r.a.tabs.get(n)).then((function(e){return t?(Object(g.a)().disable(e.id),r.a.tabs.update(e.id,{url:t})):e}),(function(){return o(t)})):o(t)},P=function(){return I(O.tabIds.panel,!0).catch((function(){d.default.get("config").then((function(t){return((t=t||{}).size||{})[t.showSidebar?"with_sidebar":"standard"]})).then((function(t){return t=t||{width:850,height:775},r.a.windows.create({type:"popup",url:r.a.extension.getURL("popup.html"),width:t.width,height:t.height}).then((function(e){if(r.a.isFirefox())return Object(o.delay)((function(){return r.a.windows.update(e.id,{width:t.width+1,height:t.height+1})}),1e3)})),!0}))}))},C=function(){return P().then((function(){return Object(o.until)("panel tab id recorded",(function(){return{pass:O.tabIds.panel}}))})).then((function(){return Object(o.delay)((function(){}),2e3)})).then((function(){return S(2e3)}))},N=function(t){var e=p({clear:!1,text:"",color:"#ff0000",blink:0},t||{}),n=e.clear,o=e.text,a=e.color,i=e.blink;return n?r.a.browserAction.setBadgeText({text:""}):(r.a.browserAction.setBadgeBackgroundColor({color:a}),r.a.browserAction.setBadgeText({text:o}),i&&setTimeout((function(){r.a.browserAction.getBadgeText({}).then((function(t){return t===o&&r.a.browserAction.setBadgeText({text:""})}))}),i),!0)},L=function(t,e){return N(p({color:"#ff0000",text:"R"},e||{},{clear:!t}))},k=function(t,e){return N(p({color:"#ffa800",text:"S"},e||{},{clear:!t}))},D=function(t,e){return N(p({color:"#14c756",text:"P"},e||{},{clear:!t}))},j=function(t){var e,n=Object(o.uid)();r.a.notifications.create(n,{type:"basic",iconUrl:"./logo.png",title:"Record command!",message:(e=[],e.push("command: "+t.cmd),t.target&&e.push("target: "+t.target),t.value&&e.push("value: "+t.value),e.join("\n"))}),setTimeout((function(){r.a.notifications.clear(n).catch((function(t){return u.a.error(t)}))}),2e3)},x=function t(e){Promise.all([r.a.tabs.get(e),S().catch((function(){return null}))]).then((function(n){var a=v(n,2),i=a[0],u=a[1];if(u&&-1===i.url.indexOf(r.a.extension.getURL("")))return i.title&&0!==i.title.trim().length?u.ask("UPDATE_ACTIVE_TAB",{url:i.url,title:i.title}):Object(o.delay)((function(){return t(e)}),200)}))},U=function(){return Promise.all([d.default.get("config").then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p({storageMode:b.StorageStrategyType.Browser},t)})),Object(m.getXFile)().getConfig()]).then((function(t){var e=v(t,2),n=e[0];e[1];return Object(b.getStorageManager)(n.storageMode)}))},M=function(t,e,n){return O.tabIds.lastInspect=O.tabIds.toInspect,t?(O.tabIds.toInspect=t,Promise.resolve(!0)):e?O.tabIds.toInspect?(O.tabIds.toInspect=null,n?Promise.resolve(!0):Object(g.a)().get(O.tabIds.toInspect).then((function(t){return t.ask("STOP_INSPECTING")})).catch((function(t){return Object(u.a)(t.stack)}))):Promise.resolve(!0):void 0},H=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wait",n=0;return O.timer&&clearInterval(O.timer),O.timer=setInterval((function(){n+=1e3,S().then((function(r){r.ask("TIMEOUT_STATUS",{type:e,past:n,total:t})})),n>=t&&clearInterval(O.timer)}),1e3),function(){return clearInterval(O.timer)}},G=function(t,e){switch("CS_ACTIVATE_ME"!==t&&Object(u.a)("onAsk",t,e),t){case"I_AM_PANEL":return O.tabIds.panel=e.sender.tab.id,O.tabIds.toPlay===e.sender.tab.id&&(Object(u.a)("I am panel, set toPlay to null"),O.tabIds.toPlay=O.tabIds.firstPlay=O.tabIds.lastPlay),!0;case"PANEL_TIME_FOR_BACKUP":return d.default.get("config").then((function(t){var e=t.enableAutoBackup,n=t.lastBackupActionTime,r=t.autoBackupInterval;if(!e)return{timeout:!1,remain:-1};var o=1*new Date-(n||0);return{timeout:o>24*r*36e5,remain:o}})).then((function(t){return t.timeout}));case"PANEL_START_RECORDING":return Object(u.a)("Start to record..."),O.status=i.a.RECORDER,L(!0),!0;case"PANEL_STOP_RECORDING":return Object(u.a)("Stop recording..."),_().then((function(t){t.ask("SET_STATUS",{status:i.b.NORMAL})})),O.status=i.a.NORMAL,O.tabIds.lastRecord=O.tabIds.toRecord,O.tabIds.toRecord=null,O.tabIds.firstRecord=null,L(!1),!0;case"PANEL_TRY_TO_RECORD_OPEN_COMMAND":if(O.status!==i.a.RECORDER)throw new Error("Not in recorder mode");return R().then((function(t){if(Object(u.a)("PANEL_TRY_TO_RECORD_OPEN_COMMAND",t),!/^(https?:|file:)/.test(t.url))throw new Error("Not a valid url to record as open command");return O.tabIds.toRecord=O.tabIds.firstRecord=t.id,S().then((function(e){var n={cmd:"open",target:t.url};e.ask("RECORD_ADD_COMMAND",n),j(n)})),!0}));case"PANEL_START_INSPECTING":return Object(u.a)("start to inspect..."),O.status=i.a.INSPECTOR,k(!0),!0;case"PANEL_STOP_INSPECTING":return Object(u.a)("start to inspect..."),O.status=i.a.NORMAL,k(!1),M(null,!0);case"PANEL_START_PLAYING":return Object(u.a)("start to play..."),O.status=i.a.PLAYER,O.xClickNeedCalibrationInfo=null,D(!0),Object(f.a)().reset(),O.timer&&clearInterval(O.timer),!0;case"PANEL_HEART_BEAT":return O.heartBeatSecret;case"PANEL_RUN_COMMAND":O.timer&&clearInterval(O.timer);var n=function(t,e){return y(),A(t,e).then((function(n){return n.ask("HEART_BEAT",{timeout:t,before:e})})).catch((function(t){throw u.a.error("at least I catched it",t.message),new Error("heart beat error thrown")}))},a=function(t){return Object(u.a)("shoudWaitForCommand",t),/andWait/i.test(t.cmd)||"open"===t.cmd},h=function(t,e){return A().then((function(r){r.ask("SET_STATUS",{status:i.b.PLAYING});var c=!1,s=function(){return n().then((function(){c=!0}),(function(t){return u.a.error(t),null}))};O.timer&&0===e.retryCount&&clearInterval(O.timer);var d=function(){switch(t.command.cmd){case"open":return 1e3*(t.command.extra&&t.command.extra.timeoutPageLoad||60);case"pause":return-1;default:return null}}();return r.ask("DOM_READY",{}).then((function(){return r.ask("RUN_COMMAND",{command:p({},t.command,{extra:p({},t.command.extra||{},{retryInfo:e})})},d)})).then((function(e){var n=a(t.command),r=!e.isIFrame&&(/AndWait/i.test(t.command.cmd)||"refresh"===t.command.cmd);if(!n)return Promise.resolve(e.data);Object(u.a)("wait!!!!",e);var i=1e3*(e.data&&e.data.extra&&e.data.extra.timeoutPageLoad||60),d=1e3*(e.data&&e.data.extra&&e.data.extra.timeoutElement||10);return r&&Object(g.a)().disable(O.tabIds.toPlay),Object(o.delay)((function(){}),2e3).then((function(){return s()})).then((function(){return Object(o.until)("player tab heart beat check",(function(){return s(),{pass:c,result:!0}}),100,d).catch((function(e){var n=t.command.cmd;if(/AndWait/.test(n)){var r=n.replace("AndWait","");throw new Error("'"+n+"' failed. No page load event detected after "+d/1e3+" seconds. Try '"+r+"' instead.")}throw new Error(n+"' failed. No page load event detected after "+d/1e3+" seconds.")}))})).then((function(){return A()})).then((function(t){var e=H(i);return t.ask("DOM_READY",{},i).then((function(){e(),t.ask("HACK_ALERT",{})}),(function(){throw e(),new Error("page load "+i/1e3+" seconds time out")}))})).then((function(){return e.data}))}))})).catch((function(t){throw u.a.error("all catched by runCommand - "+t.message),t}))},b=1e3*e.command.extra.timeoutElement,m=function(){return function(){var t=Math.random();O.timerSecret=t;var e=Object(o.retry)(h,{timeout:b,shouldRetry:function(t){return Object(u.a)("runCommandWithRetry - shouldRetry",t.message),t.message&&(-1!==t.message.indexOf("timeout reached when looking for")||-1!==t.message.indexOf("element is found but not visible yet")||-1!==t.message.indexOf("IPC Promise has been destroyed"))},onFirstFail:function(t){var e=(t&&t.message&&t.message.indexOf("element is found but not visible yet"),"Tag waiting");H(b,e)},onFinal:function(e,n){Object(u.a)("onFinal",e,n),O.timer&&O.timerSecret===t&&clearInterval(O.timer)}});return e.apply(void 0,arguments)}(e).catch((function(t){if(e.command.extra&&e.command.extra.errorIgnore)return{log:{error:t.message}};throw t}))},T=Object(o.retry)((function(){var t=function(){var t=(new Date).getTime(),r=!1,i=function i(){return Object(u.a)("starting heart beat"),a(e.command)||Object(f.a)().hasPendingDownload()?(y({disabled:!0}),new Promise((function(){}))):r?Promise.resolve():n(100,t).then((function(){return Object(o.delay)((function(){}),1e3).then(i)}),(function(t){throw u.a.error("lost heart beart!!",t.stack),new Error("lost heart beat when running command")}))};return i.stop=function(){Object(u.a)("stopping heart beat"),r=!0},i}();return Promise.race([m().then((function(e){return t.stop(),e})).catch((function(e){throw t.stop(),e})),t()])}),{timeout:b,shouldRetry:function(t){return Object(u.a)("runWithHeartBeatRetry - shouldRetry",t.message),t&&t.message&&-1!==t.message.indexOf("lost heart beat when running command")}}),N=function(){return new Promise((function(t,n){t(T().then((function(t){return function(t){return Object(u.a)("shouldWaitForDownloadAfterRun",t),"click"===t.cmd}(e.command)?Object(f.a)().waitForDownloadIfAny().then((function(){return t})):t})).then((function(t){return r.a.tabs.get(O.tabIds.toPlay).then((function(e){return p({},t,{pageUrl:e.url})})).catch((function(e){return u.a.error("Error in fetching play tab url"),t}))})))}))};return R().catch((function(t){return{id:-1}})).then((function(t){return Object(u.a)("after first getPlayTab",t),Object(g.a)().get(t.id,100).then((function(e){return{tab:t,hasOpenedUrl:!1}}),(function(t){return function(){var t=e.command,n=t.cmd,r=t.target;if("open"!==n)throw new Error("no play tab found");return R(r).then((function(t){return{tab:t,hasOpenedUrl:!0}}))}()}))})).then((function(t){var e=t.tab,n=t.hasOpenedUrl;return Promise.resolve().then((function(){return Object(g.a)().get(e.id,6e4)})).then((function(t){return(n?t.ask("MARK_NO_COMMANDS_YET",{}):Promise.resolve()).then((function(){return t.ask("SET_STATUS",{status:i.b.PLAYING})}))}))})).then(N).catch((function(t){if(u.a.error("catched by runEternally",t.stack),t&&t.message&&(-1!==t.message.indexOf("lost heart beat when running command")||-1!==t.message.indexOf("Could not establish connection")))return N();throw t}));case"PANEL_STOP_PLAYING":return D(!1),O.status=i.a.NORMAL,Object(f.a)().reset(),O.tabIds.firstPlay=O.tabIds.toPlay,O.timer&&clearInterval(O.timer),Object(g.a)().get(O.tabIds.toPlay).then((function(t){return t.ask("SET_STATUS",{status:i.b.NORMAL})}));case"PANEL_HIGHLIGHT_DOM":return Promise.all([_().then((function(t){return{ipc:t,type:"record"}})).catch((function(){return null})),A().then((function(t){return{ipc:t,type:"play"}})).catch((function(){return null}))]).then((function(t){if(!t[0]&&!t[1])throw new Error("No where to look for the dom");return t.filter((function(t){return!!t}))})).then((function(t){return Promise.all(t.map((function(t){var n=t.ipc,r=t.type;return n.ask("FIND_DOM",{locator:e.locator}).then((function(t){return{result:t,type:r,ipc:n}}))})))})).then((function(t){var n=t.filter((function(t){return t.result}));if(0===n.length)throw new Error("DOM not found");var r=2===n.length?n.find((function(t){return t.type===e.lastOperation})):n[0],o=O.tabIds["record"===r.type?"lastRecord":"toPlay"];return I(o,!0).then((function(){return r.ipc.ask("HIGHLIGHT_DOM",{locator:e.locator})}))}));case"PANEL_HIGHLIGHT_RECT":return A().then((function(t){return t.ask("HIGHLIGHT_RECT",e)}));case"PANEL_HIGHLIGHT_RECTS":return A().then((function(t){return t.ask("HIGHLIGHT_RECTS",e)}));case"PANEL_RESIZE_WINDOW":if(!O.tabIds.panel)throw new Error("Panel not available");return r.a.tabs.get(O.tabIds.panel).then((function(t){return r.a.windows.update(t.windowId,Object(o.pick)(["width","height"],p({},e.size,{width:e.size.width,height:e.size.height})))}));case"PANEL_UPDATE_BADGE":var x={play:D,record:L,inspect:k}[e.type];if(!x)throw new Error("unknown type for updating badge, '"+e.type+"'");return x(!e.clear,e);case"PANEL_NOTIFY_AUTO_PAUSE":return r.a.notifications.create({type:"basic",iconUrl:"./logo.png",title:"Replay paused!",message:"Auto paused by command"}),!0;case"PANEL_NOTIFY_BREAKPOINT":return r.a.notifications.create({type:"basic",iconUrl:"./logo.png",title:"Replay paused!",message:"Auto paused by breakpoint"}),!0;case"PANEL_NOTIFY_ECHO":return bt=e.text,r.a.notifications.create({type:"basic",iconUrl:"./logo.png",title:"Echo",message:bt}),!0;case"PANEL_CLOSE_ALL_WINDOWS":return r.a.windows.getAll().then((function(t){return Promise.all(t.map((function(t){return r.a.windows.remove(t.id)})))})),!0;case"PANEL_CURRENT_PLAY_TAB_INFO":return R().then((function(t){return{url:t.url,title:t.title}}));case"PANEL_BRING_PLAYING_WINDOW_TO_FOREGROUND":return R().then((function(t){return I(t.id,!0)})).catch((function(t){return P()})).then((function(){return!0}));case"PANEL_RESIZE_PLAY_TAB":return R().then((function(t){return Object(w.resizeViewportOfTab)(t.id,e)}));case"PANEL_SELECT_AREA_ON_CURRENT_PAGE":return A().then((function(t){return I(O.tabIds.toPlay,!0),t.ask("SELECT_SCREEN_AREA")})).catch((function(t){throw u.a.error(t.stack),new Error("Not able to take screenshot on the current tab")}));case"PANEL_CLEAR_VISION_RECTS_ON_PLAYING_PAGE":return A().then((function(t){return t.ask("CLEAR_VISION_RECTS")}));case"PANEL_SEARCH_VISION_ON_PLAYING_PAGE":var G=e.visionFileName,B=e.minSimilarity,F=e.searchArea,W=void 0===F?"full":F,Y=e.storedImageRect,V=e.command,z=(Object(o.dpiFromFileName)(G)||96)/Object(o.getScreenDpi)(),K=U(),X=function(t){return K.then((function(e){return e.getScreenshotStorage().overwrite(Object(o.ensureExtName)(".png",i.d),Object(o.dataURItoBlob)(t)).then((function(){S().then((function(t){return t.ask("RESTORE_SCREENSHOTS")}))}))}))};if(B<.1||B>1)throw new Error("confidence should be between 0.1 and 1.0");return Promise.all([function(t){return K.then((function(e){var n=e.getVisionStorage();return n.exists(t).then((function(e){if(!e)throw new Error(V+": No input image found for file name '"+t+"'");return n.read(t,"DataURL")})).then((function(t){return"data:"!==t.substr(0,5)?"data:image/png;base64,"+t:t}))}))}(G),A().then((function(t){var e=O.tabIds.toPlay;return Object(u.a)("getTargetImage tabIds",O.tabIds,e),I(e,!0).then((function(){return Object(o.delay)((function(){}),E)})).then((function(){return function(t,e){switch(W){case"viewport":return Promise.all([t.ask("SCREENSHOT_PAGE_INFO"),Object(s.c)(e)]).then((function(t){var e=v(t,2),n=e[0],r=e[1];return X(r),{offset:{x:n.originalX,y:n.originalY},dataUrl:r}}));case"full":return Object(s.b)(e,{startCapture:function(){return t.ask("START_CAPTURE_FULL_SCREENSHOT",{})},endCapture:function(e){return t.ask("END_CAPTURE_FULL_SCREENSHOT",{pageInfo:e})},scrollPage:function(e){return t.ask("SCROLL_PAGE",{offset:e})}}).then((function(t){return X(t),{dataUrl:t,offset:{x:0,y:0}}}));default:if(/^element:/i.test(W)){if(!Y)throw new Error("!storedImageRect should not be empty");var n=Object(o.ensureExtName)(".png",i.d);return U().then((function(t){return t.getScreenshotStorage().read(n,"DataURL").then((function(t){return{dataUrl:t,offset:{x:Y.x,y:Y.y}}}))}))}throw new Error("Unsupported searchArea '"+W+"'")}}(t,e)})).then((function(t){return Object(s.h)(t.dataUrl,z).then((function(e){return{dataUrl:e,offset:t.offset}}))}))}))]);case"PANEL_TIMEOUT_STATUS":return H(e.timeout,e.type),!0;case"PANEL_CLEAR_TIMEOUT_STATUS":return clearInterval(O.timer),!0;case"PANEL_TOGGLE_HIGHLIGHT_VIEWPORT":return A().then((function(t){return t.ask("TOGGLE_HIGHLIGHT_VIEWPORT",e)}));case"PANEL_XCLICK_NEED_CALIBRATION":var q=O.xClickNeedCalibrationInfo,J=function(t,e){return o.and.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}("id, top, left, width, height, activeTabId".split(/,\s*/g).map((function(n){return t[n]===e[n]}))))};return R().then((function(t){if(!t)throw new Error("no play tab found for calibration");return r.a.windows.get(t.windowId).then((function(e){var n=function(t,e){return{id:t.id,top:t.top,left:t.left,width:t.width,height:t.height,activeTabId:e}}(e,t.id);return Object(u.a)("CALIBRATION NEED???",q,n),O.xClickNeedCalibrationInfo=n,!J(n,q||{})}))}));case"CS_STORE_SCREENSHOT_IN_SELECTION":var Z=e.rect,$=e.devicePixelRatio,Q=e.fileName,tt=e.sender.tab.id;return Object(g.a)().get(tt).then((function(t){return I(O.tabIds.toPlay,!0).then((function(){return Object(o.delay)((function(){}),E)})).then((function(){return Object(s.d)(O.tabIds.toPlay,{rect:Z,devicePixelRatio:$},{startCapture:function(){return t.ask("START_CAPTURE_FULL_SCREENSHOT",{hideScrollbar:!1})},endCapture:function(e){return t.ask("END_CAPTURE_FULL_SCREENSHOT",{pageInfo:e})},scrollPage:function(e){return t.ask("SCROLL_PAGE",{offset:e})}})})).then((function(t){return U().then((function(e){return e.getScreenshotStorage().overwrite(Q,Object(o.dataURItoBlob)(t)).then((function(){return S().then((function(t){return t.ask("RESTORE_SCREENSHOTS")})),Q}))}))}))}));case"CS_SCREEN_AREA_SELECTED":var et=e.rect,nt=e.devicePixelRatio,rt=e.sender.tab.id;return Object(u.a)("CS_SCREEN_AREA_SELECTED",et,nt,rt),Object(s.e)(e.sender.tab.id,{rect:et,devicePixelRatio:nt}).then((function(t){return Object(u.a)("CS_SCREEN_AREA_SELECTED","got reuslt",t.length),C().then((function(e){return e.ask("ADD_VISION_IMAGE",{dataUrl:t})}))})).catch((function(t){throw u.a.error(t.stack),t}));case"CS_DONE_INSPECTING":return Object(u.a)("done inspecting..."),O.status=i.a.NORMAL,k(!1),M(null,!0,!0),I(O.tabIds.panel,!0),S().then((function(t){return t.ask("INSPECT_RESULT",e)}));case"CS_ACTIVATE_ME":switch(O.status){case i.a.INSPECTOR:if(!O.tabIds.toInspect)return O.tabIds.toInspect=e.sender.tab.id,setTimeout((function(){Object(g.a)().get(O.tabIds.toInspect).then((function(t){return t.ask("SET_STATUS",{status:i.b.INSPECTING})}))}),0),!0}return!1;case"CS_RECORD_ADD_COMMAND":var ot=!1;return O.status===i.a.RECORDER&&(O.tabIds.toRecord||(ot=!0,O.tabIds.toRecord=O.tabIds.firstRecord=e.sender.tab.id),O.tabIds.toRecord===e.sender.tab.id&&("pullback"===e.cmd?(O.pullback=!0,setTimeout((function(){O.pullback=!1}),2e3),!1):(setTimeout((function(){Object(g.a)().get(O.tabIds.toRecord).then((function(t){return t.ask("SET_STATUS",{status:i.b.RECORDING})}))}),0),Object(o.delay)((function(){}),1e3).then((function(){return S()})).then((function(t){return ot&&t.ask("RECORD_ADD_COMMAND",{cmd:"open",target:e.url}),O.pullback&&(e.cmd=e.cmd.replace("AndWait",""),O.pullback=!1),t.ask("RECORD_ADD_COMMAND",e)})).then((function(){return d.default.get("config")})).then((function(t){t.recordNotification&&O.status===i.a.RECORDER&&j(e)})).then((function(){return!0})))));case"CS_CLOSE_OTHER_TABS":var at=e.sender.tab.id;return r.a.tabs.get(at).then((function(t){return r.a.tabs.query({windowId:t.windowId}).then((function(t){return t.filter((function(t){return t.id!==at}))})).then((function(t){return r.a.tabs.remove(t.map((function(t){return t.id})))}))})).then((function(){return!0}));case"CS_SELECT_WINDOW":var it=e.sender.tab.id,ut=Object(o.splitIntoTwo)("=",e.target),ct=v(ut,2),st=ct[0],dt=ct[1];if(!dt)throw new Error("invalid window locator, '"+e.target+"'");var lt=void 0;switch(st.toLowerCase()){case"title":lt=r.a.tabs.query({title:dt});break;case"tab":if(/^\s*open\s*$/i.test(dt))lt=r.a.tabs.create({url:e.value}).then((function(t){return[t]}));else{var ft=parseInt(dt,10);if(isNaN(ft))throw new Error("invalid tab offset, '"+dt+"'");lt=r.a.tabs.get(O.tabIds.firstPlay).then((function(t){return r.a.tabs.query({windowId:t.windowId,index:t.index+ft})}))}break;default:throw new Error("window locator type '"+st+"' not supported")}return lt.then((function(t){if(0===t.length)throw new Error("failed to find the tab with locator '"+e.target+"'");return t[0]})).then((function(t){return Object(u.a)("selectWindow, got tab",t),Object(g.a)().get(t.id,1e4).catch((function(t){if(/tab=\s*open\s*/i.test(e.target))throw new Error("To open a new tab, a valid URL is needed");throw t})).then((function(t){return Object(u.a)("selectWindow, got ipc",t),t.ask("DOM_READY",{}).then((function(){return t.ask("SET_STATUS",{status:i.b.PLAYING}),!0}))})).then((function(){Object(u.a)("selectWindow, set orignial to normal"),Object(g.a)().get(it).then((function(t){return t.ask("SET_STATUS",{status:i.b.NORMAL})}))})).then((function(){return O.tabIds.lastPlay=O.tabIds.toPlay,O.tabIds.toPlay=t.id,I(t.id)}))})).catch((function(t){throw u.a.error(t.stack),t}));case"CS_CAPTURE_SCREENSHOT":return I(O.tabIds.toPlay,!0).then((function(){return Object(o.delay)((function(){}),E)})).then((function(){return Object(s.g)(O.tabIds.toPlay,e.fileName)}));case"CS_CAPTURE_FULL_SCREENSHOT":return I(O.tabIds.toPlay,!0).then((function(){return Object(o.delay)((function(){}),E)})).then(A).then((function(t){return Object(s.f)(O.tabIds.toPlay,e.fileName,{startCapture:function(){return t.ask("START_CAPTURE_FULL_SCREENSHOT",{})},endCapture:function(e){return t.ask("END_CAPTURE_FULL_SCREENSHOT",{pageInfo:e})},scrollPage:function(e){return t.ask("SCROLL_PAGE",{offset:e})}})}));case"CS_TIMEOUT_STATUS":return S().then((function(t){return t.ask("TIMEOUT_STATUS",e)}));case"CS_DELETE_ALL_COOKIES":var ht=e.url;return r.a.cookies.getAll({url:ht}).then((function(t){var e=t.map((function(t){return r.a.cookies.remove({url:""+ht+t.path,name:t.name})}));return Promise.all(e)}));case"CS_SET_FILE_INPUT_FILES":return Object(l.a)({tabId:e.sender.tab.id,selector:e.selector,files:e.files});case"CS_ON_DOWNLOAD":Object(f.a)().prepareDownload(e.fileName,{wait:!!e.wait,timeout:e.timeout,timeoutForStart:e.timeoutForStart});return!0;case"CS_INVOKE":return d.default.get("config").then((function(t){e.testCase;var n=!!e.testSuite;switch(e.testCase&&e.testCase.from||e.testSuite&&e.testSuite.from){case"bookmark":if(!t.allowRunFromBookmark)throw new Error("To run macro / test suite from bookmarks, enable it in kantu settings first");break;case"html":if(!n)throw new Error("not allowed to run from local file");var r=/^file:\/\//.test(e.sender.url),o=/^https?:\/\//.test(e.sender.url);if(r&&!t.allowRunFromFileSchema)throw new Error("To run test suite from local file, enable it in kantu settings first");if(o&&!t.allowRunFromHttpSchema)throw new Error("To run test suite from public website, enable it in kantu settings first");break;default:throw new Error("unknown source not allowed")}return C().then((function(t){return e.testCase?t.ask("RUN_TEST_CASE",{testCase:e.testCase,options:e.options}):!e.testSuite||t.ask("RUN_TEST_SUITE",{testSuite:e.testSuite,options:e.options})}))}));case"CS_IMPORT_HTML_AND_INVOKE":return d.default.get("config").then((function(t){var n=/^file:\/\//.test(e.sender.url),r=/^https?:\/\//.test(e.sender.url);if(n&&!t.allowRunFromFileSchema)throw new Error("To run macro from local file, enable it in kantu settings first");if(r&&!t.allowRunFromHttpSchema)throw new Error("To run macro from public website, enable it in kantu settings first");return C().then((function(t){return t.ask("IMPORT_HTML_AND_RUN",e)}))}));case"CS_ADD_LOG":return S().then((function(t){return t.ask("ADD_LOG",e)}));case"SET_CLIPBOARD":return c.a.set(e.value),!0;case"GET_CLIPBOARD":return c.a.get();default:return"unknown"}var bt};r.a.browserAction.onClicked.addListener((function(){r.a.storage.local.get("upgrade_not_viewed").then((function(t){return"not_viewed"!==t.upgrade_not_viewed})).then((function(t){return t?P():(r.a.browserAction.setBadgeText({text:""}),r.a.storage.local.set({upgrade_not_viewed:""}),r.a.tabs.create({url:h.a.urlAfterUpgrade}))}))})),r.a.tabs.onUpdated.addListener((function(t,e,n){n.active&&function(t){return r.a.tabs.get(t).then((function(e){if(!e.active)return!1;switch(O.status){case i.a.NORMAL:return r.a.windows.get(e.windowId).then((function(t){return t.focused}));case i.a.PLAYER:return t===O.tabIds.toPlay;case i.a.RECORDER:return t===O.tabIds.toRecord;default:throw new Error("isTabActiveAndFocused: unknown app status, '"+O.status+"'")}})).catch((function(t){return!1}))}(t).then((function(e){if(e)return x(t)}))})),r.a.windows.onFocusChanged.addListener((function(t){r.a.tabs.query({windowId:t,active:!0}).then((function(t){0!==t.length&&Object(g.a)().get(t[0].id,100).then((function(t){return t.ask("TAB_ACTIVATED",{})}),(function(t){return"Comment: ingore this error"}))}))})),r.a.tabs.onActivated.addListener((function(t){if(t.tabId!==O.tabIds.panel)switch(Object(g.a)().get(t.tabId,100).then((function(t){return t.ask("TAB_ACTIVATED",{})}),(function(t){return"Comment: ingore this error"})),x(t.tabId),O.status){case i.a.NORMAL:setTimeout((function(){r.a.tabs.get(t.tabId).then((function(e){-1===e.url.indexOf(r.a.extension.getURL(""))&&(Object(u.a)("in tab activated, set toPlay to ",t),O.tabIds.lastPlay=O.tabIds.toPlay,O.tabIds.toPlay=O.tabIds.firstPlay=t.tabId)}))}),100);break;case i.a.RECORDER:Object(g.a)().get(t.tabId,5e3).then((function(t){return Object(o.delay)((function(){return t}),1e3)})).then((function(t){return t.ask("SET_STATUS",{status:i.b.RECORDING})})).then((function(){return _().then((function(t){t.ask("SET_STATUS",{status:i.b.NORMAL})}))})).then((function(){var e=O.tabIds.firstRecord,n=t.tabId;return Promise.all([r.a.tabs.get(e),r.a.tabs.get(n)]).then((function(e){var n=v(e,2),r=n[0],o=n[1],a=[];return O.tabIds.toRecord=t.tabId,r.windowId===o.windowId&&a.push("tab="+(o.index-r.index)),a.push("title="+o.title),{target:a[0],targetOptions:a}}))})).then((function(t){var e=p({cmd:"selectWindow"},t);return S().then((function(t){return t.ask("RECORD_ADD_COMMAND",e)})).then((function(){return j(e)}))})).catch((function(t){u.a.error(t.stack)}))}})),Object(a.a)((function(t,e,n){Object(u.a)("connect cs ipc",t,e,n),Object(g.a)().set(t,n,e),n.onAsk(G)})),void 0!==t&&(r.a.runtime.setUninstallURL(h.a.urlAfterUninstall),r.a.runtime.onInstalled.addListener((function(t){switch(t.reason){case"install":return r.a.tabs.create({url:h.a.urlAfterInstall});case"update":return r.a.browserAction.setBadgeText({text:"NEW"}),r.a.browserAction.setBadgeBackgroundColor({color:"#4444FF"}),r.a.storage.local.set({upgrade_not_viewed:"not_viewed"})}}))),r.a.windows.getCurrent().then((function(t){return r.a.tabs.query({active:!0,windowId:t.id}).then((function(t){return!(!t||!t.length||(Object(u.a)("in initPlayTab, set toPlay to",t[0]),O.tabIds.lastPlay=O.tabIds.toPlay,O.tabIds.toPlay=t[0].id,0))}))})),Object(f.a)().onCountDown((function(t){S().then((function(e){e.ask("TIMEOUT_STATUS",p({},t,{type:"download"}))}))})),window.clip=c.a}.call(this,n(39))},71:function(t,e,n){"use strict";var r=n(3),o=n.n(r).a.isFirefox()?"firefox":"chrome";e.a={preinstallVersion:"3.3.1",urlAfterUpgrade:"https://ui.vision/web-automation/"+o+"/whatsnew",urlAfterInstall:"https://ui.vision/web-automation/"+o+"/welcome",urlAfterUninstall:"https://ui.vision/web-automation/"+o+"/why"}},75:function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return h}));var r=n(60),o=n.n(r),a=n(32),i=n(3),u=n.n(i),c=n(4),s=n(2),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(t){var e=function(e){return e+"_"+t};return{ipcCs:function(t){var n=[];return u.a.runtime.onMessage.addListener((function(t,e,r){return n.forEach((function(n){return n(t,e,r)})),!0})),o()({timeout:-1,checkReady:t,ask:function(t,n,r){u.a.runtime.sendMessage({type:e("CS_ASK_BG"),uid:t,cmd:n,args:r})},onAnswer:function(t){n.push((function(n,r,o){n.type===e("BG_ANSWER_CS")&&t(n.uid,n.err,n.data)}))},onAsk:function(t){n.push((function(n,r,o){n.type===e("BG_ASK_CS")&&t(n.uid,n.cmd,n.args)}))},answer:function(t,n,r){u.a.runtime.sendMessage({type:e("CS_ANSWER_BG"),uid:t,err:n,data:r})},destroy:function(){n=[]}})},ipcBg:function(t){var n=[],r=function(t,e){return t&&"object"===(void 0===t?"undefined":d(t))?(t.sender=e,t):t};return u.a.runtime.onMessage.addListener((function(t,e,r){return n.forEach((function(n){return n(t,e,r)})),!0})),o()({timeout:-1,ask:function(n,r,o){u.a.tabs.sendMessage(t,{type:e("BG_ASK_CS"),uid:n,cmd:r,args:o})},onAnswer:function(t){n.push((function(n,o,a){n.type===e("CS_ANSWER_BG")&&t(n.uid,n.err,r(n.data,o))}))},onAsk:function(t){n.push((function(n,o,a){n.type===e("CS_ASK_BG")&&t(n.uid,n.cmd,r(n.args,o))}))},answer:function(n,r,o){u.a.tabs.sendMessage(t,{type:e("BG_ANSWER_CS"),uid:n,err:r,data:o})},destroy:function(){n=[]}})}}},f=function(){var t=""+Math.floor(1e4*Math.random());if(Object(c.a)("sending Connect..."),u.a.extension.getURL)try{var e=Object(s.retry)((function(){return Object(s.withTimeout)(1e3,(function(){return u.a.runtime.sendMessage({type:"CONNECT",cuid:t}).then((function(e){if(e)return l(t).ipcCs();throw new Error("not done")}))}))}),{shouldRetry:function(){return!0},retryInterval:0,timeout:5e3});return Object(s.mockAPIWith)((function(){return Object(s.withTimeout)(500,(function(){return u.a.runtime.sendMessage({type:"RECONNECT"}).then((function(t){if(Object(c.a)("got existing cuid",t),t)return l(t).ipcCs();throw new Error("failed to reconnect")}))})).catch((function(){return e()})).catch((function(t){throw c.a.error("Failed to create cs ipc"),t}))}),{ask:function(){return Promise.reject(new Error("mock ask"))},onAsk:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];c.a.apply(void 0,["mock onAsk"].concat(e))},destroy:function(){}},["ask"])}catch(t){c.a.error(t.stack)}},h=function(t){u.a.runtime.onMessage.addListener((function(e,n,r){switch(e.type){case"CONNECT":e.cuid&&(t(n.tab.id,e.cuid,l(e.cuid).ipcBg(n.tab.id)),r(!0));break;case"RECONNECT":var o=Object(a.a)().getCuid(n.tab.id);o&&Object(a.a)().enable(n.tab.id),r(o||null)}return!0}))}},8:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"h",(function(){return d})),n.d(e,"d",(function(){return l}));var r=function(t){return t.reduce((function(t,e){return t[e]=e,t}),{})},o=r(["NORMAL","INSPECTOR","RECORDER","PLAYER"]),a=r(["PENDING","INSPECTING","STOPPED"]),i=r(["PENDING","RECORDING","STOPPED"]),u=r(["PLAYING","PAUSED","STOPPED"]),c=r(["TEST_CASE","TEST_SUITE"]),s=r(["NORMAL","RECORDING","INSPECTING","PLAYING"]),d=r(["NORMAL","SUCCESS","ERROR"]),l="__lastscreenshot"}});